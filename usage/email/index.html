<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="canonical" href="https://docs.ixpmanager.org/usage/email/">
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Email - IXP Manager Documentation</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Email";
    var mkdocs_page_input_path = "usage/email.md";
    var mkdocs_page_url = "/usage/email/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> IXP Manager Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Installation</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/automated-script/">Automated Script</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/maint-mode/">Maintenance Mode</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/manually/">Manual Installation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/upgrading/">Upgrading</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/runtime/">Runtime Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../install/next-steps/">Post-Install Steps</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">General Usage</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../operational-notes/">Operational Notes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../authentication/">Authentication</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../contacts/">Contacts</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../customers/">Customers / Members</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../customer-notes/">Customer Notes</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../customer-tags/">Customer Tags</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../interfaces/">Customer Connections</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../users/">Users</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../switches/">Switches</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Email</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#configuring-smtp">Configuring SMTP</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#sender-identity">Sender Identity</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#testing-smtp">Testing SMTP</a>
    </li>
    </ul>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Features</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/api/">API</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/as112/">AS112</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/console-servers/">Console Servers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/cronjobs/">Cron Jobs</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/patch-panels/">Cross Connects</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/dns-arpa/">DNS / ARPA</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/docstore/">Document Store</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/introduction/">Grapher</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/helpdesk/">Helpdesk Integration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/irrdb/">IRRDB</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/ixf-export/">IX-F Member Export</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/looking-glass/">Looking Glass</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/layer2-addresses/">MAC Addresses</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/manrs/">MANRS</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/member-export/">Member Export</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/mailing-lists/">Mailing List Management</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/nagios/">Nagios</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/patch-panels/">Patch Panels</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/peering-manager/">Peering Manager</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/peering-matrix/">Peering Matrix</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/peeringdb/">PeeringDB</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/rir-objects/">RIR Objects</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/reseller/">Reseller Functionality</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/route-collectors/">Route Collectors</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/route-servers/">Route Servers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/routers/">Router Configuration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/rpki/">RPKI</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/skinning/">Skinning</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/smokeping/">Smokeping</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/static-content/">Static Content</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/tacacs/">TACACS</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Grapher</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/introduction/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/api/">API &amp; Permissions</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/mrtg/">Backend: MRTG</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/sflow/">Backend: sflow</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../grapher/smokeping/">Backend: Smokeping</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Sflow Support</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/sflow/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../features/sflow-p2p/">Peer-to-peer Graphs</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Development</span></p>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/introduction/">Introduction</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/api/">API</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/authentication/">Authentication</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/ci/">Continuous Integration</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/cla/">Contributer License Agreement</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/docker/">Docker</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/docs/">Documentation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/forms/">Forms</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/frontend-crud/">Frontend CRUD</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/grapher/">Grapher</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/helpders/">Helpers</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/looking-glass/">Looking Glass</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/release-procedure/">Release Procedure</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/telescope/">Telescope</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/users/">Users</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../../dev/vagrant/">Vagrant</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">IXP Manager Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>General Usage &raquo;</li>
        
      
    
    <li>Email</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/inex/ixp-manager-docs-md/edit/master/docs/usage/email.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="configuring-email">Configuring Email<a class="headerlink" href="#configuring-email" title="Permanent link"></a></h1>
<p><strong>IXP Manager</strong> uses Laravel's <a href="https://laravel.com/docs/7.x/mail">mail system</a> to send email. This system allows for many possible email sending drivers (such as Mailgun, Postmark, Amazon SES, etc.). If you wish to use one of these services than please <a href="https://laravel.com/docs/7.x/mail">refer to the official documentation</a>. You can also read the <code>config/mail.php</code> configuration file in your <strong>IXP Manager</strong> installation for further details.</p>
<p>This guide will explain how to configure and test <strong>IXP Manager</strong> to send email using a standard SMTP service.</p>
<h2 id="configuring-smtp">Configuring SMTP<a class="headerlink" href="#configuring-smtp" title="Permanent link"></a></h2>
<p>A sample SMTP configuration block in your <strong>IXP Manager</strong> <code>.env</code> file would be:</p>
<pre class="highlight"><code>MAIL_DRIVER="smtp"
# MAIL_HOST="localhost"
# MAIL_PORT="25"
# MAIL_ENCRYPTION="tls"
# MAIL_USERNAME=
# MAIL_PASSWORD=</code></pre>

<p>The options that are commented out above show defaults. Under the hood, Laravel in turn uses <a href="https://swiftmailer.symfony.com/docs/sending.html">swiftmailer</a> and the parameters above are passed through to that library.</p>
<p>The configuration options for SMTP in the <code>.env</code> file are as follows.</p>
<p><code>MAIL_MAILER="smtp"</code> - this is the mail transport to use. The default is to try and use a local <code>sendmail</code> binary <strong>so it is important to set this</strong>. The other available options are outside the scope of this documentation.</p>
<p><code>MAIL_HOST</code> is the hostname or IP address of your SMTP relay server. We would generally expect an IXP to have an internal SMTP relay server within the management network to handle the sending of email from monitoring systems, cron processes, IXP Manager, etc. This can also be <code>localhost</code> or <code>127.0.0.1</code> if you are running a local daemon such as Postfix.</p>
<p><code>MAIL_PORT</code> is the TCP port which the mail relay server listens for connections. Typical values are <code>587</code> for TLS encrypted mail servers and <code>25</code> for unencrypted mail servers (these should be on your local network only - if you are using a third party or remote relay service, you should use TLS or SSL encryption).</p>
<p><code>MAIL_ENCRYPTION</code> can be <code>"tls"</code> or <code>"ssl"</code> for encryption. If you are using localhost or an internal relay server without encryption, set this to <code>MAIL_ENCRYPTION=false</code>. <strong>NB:</strong> this is important as the default is to use TLS encryption.</p>
<p>Finally, <code>MAIL_USERNAME</code> and <code>MAIL_PASSWORD</code> can be set if your mail relay server requires authentication. If unset, then no authentication is assumed (which is the default).</p>
<p>A local SMTP relay server on the same host as <strong>IXP Manager</strong> would therefore require a configuration such as:</p>
<pre class="highlight"><code>MAIL_DRIVER="smtp"
MAIL_HOST="localhost"
MAIL_PORT="25"
MAIL_ENCRYPTION=false
# MAIL_USERNAME=
# MAIL_PASSWORD=</code></pre>

<h2 id="sender-identity">Sender Identity<a class="headerlink" href="#sender-identity" title="Permanent link"></a></h2>
<p><strong>IXP Manager</strong> sends emails using the name and email address configured in the following <code>.env</code> parameters:</p>
<pre class="highlight"><code>IDENTITY_NAME="${IDENTITY_LEGALNAME}"
IDENTITY_EMAIL="ixp@example.com"</code></pre>

<p>Where <code>${IDENTITY_LEGALNAME}</code> means use the value as configured in the <code>IDENTITY_LEGALNAME</code> <code>.env</code> parameter.</p>
<p>You should set these as appropriate to your IXP.</p>
<h2 id="testing-smtp">Testing SMTP<a class="headerlink" href="#testing-smtp" title="Permanent link"></a></h2>
<p>A new Artisan SMTP test utility was introduced in <strong>IXP Manager</strong> &gt;v5.7.0. You can run it as follows:</p>
<pre class="highlight"><code class="language-sh">$ php artisan utils:smtp-mail-test [-v] {recipient-email}</code></pre>

<p>A example of a working test run looks like this:</p>
<pre class="highlight"><code>$ php artisan utils:smtp-mail-test me@example.com
This utility allows you to test your SMTP settings to verify that IXP Manager can send email.

Testing using the following parameters:

+------------+---------------------+
| Driver     | smtp                |
| Host       | localhost           |
| Port       | 25                  |
| Encryption |                     |
| Username   |                     |
| Password   |                     |
| From Name  | INEX DEV IXP        |
| From Email | test@ixpmanager.org |
+------------+---------------------+



Trying to send email...

SUCCESS - email has been sent.</code></pre>

<p>If you add the verbose option you will also be shown the SMTP dialog:</p>
<pre class="highlight"><code>$ php artisan utils:smtp-mail-test -v me@example.com

...

========================================
SMTP Dialog:

++ Starting Swift_SmtpTransport
&lt;&lt; 220 mail.example.com ESMTP Postfix

&gt;&gt; EHLO [127.0.0.1]

&lt;&lt; 250-mail.example.com
250-PIPELINING
250-SIZE 80200000
250-VRFY
250-ETRN
250-STARTTLS
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-DSN
250 SMTPUTF8

&gt;&gt; STARTTLS

&lt;&lt; 220 2.0.0 Ready to start TLS

...</code></pre>

<p>If there is an error sending an email, it will provide the exception thrown and the error message:</p>
<pre class="highlight"><code>...
Trying to send email...

FAILED TO SEND EMAIL!



Exception thrown: ErrorException
Error: stream_socket_enable_crypto(): Peer certificate CN=`mail.example.com' did not match expected CN=`192.0.2.16'
File: /tmp/dev/ixpm/vendor/swiftmailer/swiftmailer/lib/classes/Swift/Transport/StreamBuffer.php
Line: 94</code></pre>

<p>Similarly, if you provide the verbose option in the case of an error, you will be provided with a stack trace and the SMTP dialog.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../features/api/" class="btn btn-neutral float-right" title="API">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../switches/" class="btn btn-neutral" title="Switches"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>&copy; 2017-2020, Internet Neutral Exchange Association Company Limited by Guarantee (INEX).<br><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" /></a>&nbsp;This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/inex/ixp-manager-docs-md/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../switches/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../features/api/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
