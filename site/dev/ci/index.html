<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Continuous Integration - IXP Manager Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Continuous Integration";
    var mkdocs_page_input_path = "dev/ci.md";
    var mkdocs_page_url = "/dev/ci/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> IXP Manager Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Installation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../install/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../install/automated-script/">Automated Script</a>
                </li>
                <li class="">
                    
    <a class="" href="../../install/maint-mode/">Maintenance Mode</a>
                </li>
                <li class="">
                    
    <a class="" href="../../install/manually/">Manual Installation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../install/upgrading/">Upgrading</a>
                </li>
                <li class="">
                    
    <a class="" href="../../install/runtime/">Runtime Configuration</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">General Usage</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../usage/contacts/">Contacts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../usage/customers/">Customers / Members</a>
                </li>
                <li class="">
                    
    <a class="" href="../../usage/customer-notes/">Customer Notes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../usage/customer-tags/">Customer Tags</a>
                </li>
                <li class="">
                    
    <a class="" href="../../usage/interfaces/">Customer Connections</a>
                </li>
                <li class="">
                    
    <a class="" href="../../usage/users/">Users</a>
                </li>
                <li class="">
                    
    <a class="" href="../../usage/switches/">Switches</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Features</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../features/api/">API</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/as112/">AS112</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/console-servers/">Console Servers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/cronjobs/">Cron Jobs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/patch-panels/">Cross Connects</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/dns-arpa/">DNS / ARPA</a>
                </li>
                <li class="">
                    
    <a class="" href="../../grapher/introduction/">Grapher</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/helpdesk/">Helpdesk Integration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/irrdb/">IRRDB</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/ixf-export/">IX-F Member Export</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/looking-glass/">Looking Glass</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/layer2-addresses/">MAC Addresses</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/manrs/">MANRS</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/member-export/">Member Export</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/mailing-lists/">Mailing List Management</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/nagios/">Nagios</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/patch-panels/">Patch Panels</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/peering-manager/">Peering Manager</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/peering-matrix/">Peering Matrix</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/peeringdb/">PeeringDB</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/rir-objects/">RIR Objects</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/reseller/">Reseller Functionality</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/route-collectors/">Route Collectors</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/route-servers/">Route Servers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/routers/">Router Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/rpki/">RPKI</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/skinning/">Skinning</a>
                </li>
                <li class="">
                    
    <a class="" href="../../grapher/smokeping/">Smokeping</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/static-content/">Static Content</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/tacacs/">TACACS</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Grapher</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../grapher/introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../grapher/api/">API &amp; Permissions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../grapher/mrtg/">Backend: MRTG</a>
                </li>
                <li class="">
                    
    <a class="" href="../../grapher/sflow/">Backend: sflow</a>
                </li>
                <li class="">
                    
    <a class="" href="../../grapher/smokeping/">Backend: Smokeping</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Sflow Support</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../features/sflow/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../../features/sflow-p2p/">Peer-to-peer Graphs</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Development</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../introduction/">Introduction</a>
                </li>
                <li class="">
                    
    <a class="" href="../api/">API</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Continuous Integration</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#continuous-integration">Continuous Integration</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#setting-up-phpunit-tests">Setting Up PHPUnit Tests</a></li>
        
            <li><a class="toctree-l4" href="#setting-up-laravel-dusk">Setting Up Laravel Dusk</a></li>
        
            <li><a class="toctree-l4" href="#test-database-notes">Test Database Notes</a></li>
        
            <li><a class="toctree-l4" href="#running-tests">Running Tests</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../cla/">Contributer License Agreement</a>
                </li>
                <li class="">
                    
    <a class="" href="../docker/">Docker</a>
                </li>
                <li class="">
                    
    <a class="" href="../docs/">Documentation</a>
                </li>
                <li class="">
                    
    <a class="" href="../forms/">Forms</a>
                </li>
                <li class="">
                    
    <a class="" href="../frontend-crud/">Frontend CRUD</a>
                </li>
                <li class="">
                    
    <a class="" href="../grapher/">Grapher</a>
                </li>
                <li class="">
                    
    <a class="" href="../helpders/">Helpers</a>
                </li>
                <li class="">
                    
    <a class="" href="../looking-glass/">Looking Glass</a>
                </li>
                <li class="">
                    
    <a class="" href="../release-procedure/">Release Procedure</a>
                </li>
                <li class="">
                    
    <a class="" href="../telescope/">Telescope</a>
                </li>
                <li class="">
                    
    <a class="" href="../users/">Users</a>
                </li>
                <li class="">
                    
    <a class="" href="../vagrant/">Vagrant</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">IXP Manager Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Development &raquo;</li>
        
      
    
    <li>Continuous Integration</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/inex/ixp-manager-docs-md/edit/master/docs/dev/ci.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="continuous-integration">Continuous Integration<a class="headerlink" href="#continuous-integration" title="Permanent link"></a></h1>
<p>IXP Manager grew out of a code base and schema that started in the early '90s. Long before <a href="http://phpunit.de/">test driven development</a> or <a href="http://behat.org/">behaviour driven development</a> was fashionable for PHP. However, as IXP Manager is taking over more and more critical configuration tasks, we continue to back fill some automated testing with continuous integration for critical elements.</p>
<p>We use <a href="https://travis-ci.org/inex/IXP-Manager">Travis-CI</a> for continuous integration (CI) who provide free cloud based CI linked to GitHub for open source projects.</p>
<p>Our current build status is: <a href="https://travis-ci.org/inex/IXP-Manager"><img alt="Build Status" src="https://travis-ci.org/inex/IXP-Manager.png?branch=master" /></a></p>
<p>The CI system runs the full suite of tests every time a commit is pushed to GitHub. As such, any <em>build failing</em> states are usually transitory. <strong>Official IXP Manager releases are only made when all tests pass.</strong></p>
<p>We use two types of unit tests:</p>
<ol>
<li><a href="http://phpunit.de/">PHP Unit</a> for standard unit tests;</li>
<li><a href="https://laravel.com/docs/5.6/dusk">Laravel Dusk</a> for browser based tests.</li>
</ol>
<p>We won't be aggressively writing tests for the existing codebase but will add tests as appropriate as we continue development. What follows is some basic instructions on how to set up tests and an overview (or links) to some of the tests we have implemented.</p>
<p><strong>DISCLAIMER:</strong> This is not a tutorial on unit testing, phpunit, Laravel Dusk or anything else. If you have no experience with these tools, please read up on them elsewhere first.</p>
<h2 id="setting-up-phpunit-tests">Setting Up PHPUnit Tests<a class="headerlink" href="#setting-up-phpunit-tests" title="Permanent link"></a></h2>
<p>Documentation by real example can be found via the <a href="https://github.com/inex/IXP-Manager/blob/master/.travis.yml">.travis.yml</a> file and <a href="https://github.com/inex/IXP-Manager/tree/master/data/travis-ci">the Travis data directory</a> which contains scripts, database dumps and configurations.</p>
<p>Testing assumes <em>a known good sample database</em> which contains a small mix of customers with different configuration options. The files generated from this database are tested against <a href="https://github.com/inex/IXP-Manager/tree/master/data/travis-ci/known-good">known good</a> configuration files. You first need to create a database, add a database user, import this testing database and then configure a <code>.env</code> section for testing.</p>
<p>In MySQL:</p>
<pre class="highlight"><code class="language-mysql">CREATE DATABASE ixp_ci CHARACTER SET = 'utf8mb4' COLLATE = 'utf8mb4_unicode_ci';
GRANT ALL ON `ixp_ci`.* TO `ixp_ci`@`localhost` IDENTIFIED BY 'somepassword';
FLUSH PRIVILEGES;</code></pre>

<p>Then import the sample database:</p>
<pre class="highlight"><code class="language-sh">bzcat data/travis-ci/travis_ci_test_db.sql.bz2  | mysql -h localhost -u ixp_ci -psomepassword ixp_ci</code></pre>

<p>Now, create your <code>.env</code> for testing, such as:</p>
<pre class="highlight"><code class="language-ini">DB_HOST=localhost
DB_DATABASE=ixp_ci
DB_USERNAME=ixp_ci
DB_PASSWORD=somepassword</code></pre>

<p>Note that the <a href="https://github.com/inex/IXP-Manager/blob/master/phpunit.xml"><code>phpunit.xml</code></a> file in the root directory has some default settings matching the test database. You should not need to edit these.</p>
<p>The <code>.env</code> file used by Travis CI can be <a href="https://github.com/inex/IXP-Manager/blob/master/.env.travisci">seen here</a> and - as it's used by Travis CI to run the tests - it should be a complete example of what is required.</p>
<h2 id="setting-up-laravel-dusk">Setting Up Laravel Dusk<a class="headerlink" href="#setting-up-laravel-dusk" title="Permanent link"></a></h2>
<p>Please review the <a href="https://laravel.com/docs/5.6/dusk">official documentation here</a>.</p>
<p>You need to ensure the development packages for IXP Manager are installed via:</p>
<pre class="highlight"><code class="language-sh"># move to the root directory of IXP Manager
cd $IXPROOT
composer install --dev</code></pre>

<p>You need to set the <code>APP_URL</code> environment variable in your <code>.env file</code>. This value should match the URL you use to access your application in a browser.</p>
<h2 id="test-database-notes">Test Database Notes<a class="headerlink" href="#test-database-notes" title="Permanent link"></a></h2>
<ol>
<li>The <em>SUPERADMIN</em> username / password is one-way hashed using bcrypt. If you want to log into the frontend of the test databse, these details are: <code>travis</code> / <code>travisci</code>.</li>
<li>There are two test <em>CUSTADMIN</em> accounts which can be accessed using username / password: <code>hecustadmin</code> / <code>travisci</code> and <code>imcustadmin</code> / <code>travisci</code>.</li>
<li>There are two test <em>CUSTUSER</em> accounts which can be accessed using username / password: <code>hecustuser</code> / <code>travisci</code> and <code>imcustuser</code> / <code>travisci</code>.</li>
</ol>
<h2 id="running-tests">Running Tests<a class="headerlink" href="#running-tests" title="Permanent link"></a></h2>
<p>In one console session, start the artisan / Laravel web server:</p>
<pre class="highlight"><code class="language-sh"># move to the root directory of IXP Manager
cd $IXPROOT
php artisan serve</code></pre>

<p>And then kick off <strong>all the tests</strong> which includes PHPUnit and Laravel Dusk tests, run:</p>
<pre class="highlight"><code class="language-sh">phpunit</code></pre>

<p>Sample output:</p>
<pre class="highlight"><code>PHPUnit 7.2.2 by Sebastian Bergmann and contributors.

...............................................................  63 / 144 ( 43%)
............................................................... 126 / 144 ( 87%)
..................                                              144 / 144 (100%)

Time: 1.86 minutes, Memory: 103.73MB</code></pre>

<p>If you only want to run Laravel Dusk / browser tests, run the following (shown with sample output):</p>
<pre class="highlight"><code class="language-sh">$ php artisan dusk
PHPUnit 6.5.8 by Sebastian Bergmann and contributors.

..                                                                  2 / 2 (100%)

Time: 12.73 seconds, Memory: 24.00MB</code></pre>

<p>If you want to exclude the browser based tests, just exclude that directory as follows:</p>
<pre class="highlight"><code class="language-sh">$ phpunit --filter '/^((?!Tests\\Browser).)*$/'
PHPUnit 7.2.2 by Sebastian Bergmann and contributors.

...............................................................  63 / 142 ( 44%)
............................................................... 126 / 142 ( 88%)
................                                                142 / 142 (100%)

Time: 1.59 minutes, Memory: 106.41MB</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../cla/" class="btn btn-neutral float-right" title="Contributer License Agreement">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../api/" class="btn btn-neutral" title="API"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>&copy; 2017-2019, Internet Neutral Exchange Association Company Limited by Guarantee (INEX).<br><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" /></a>&nbsp;This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/inex/ixp-manager-docs-md/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../api/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../cla/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
