


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <link rel="canonical" href="https://docs.ixpmanager.org/features/nagios/">
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.5.12">
    
    
      
        <title>Nagios - IXP Manager Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4dd2dd8d.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nagios-monitoring" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-announce">
          <div class="md-announce__inner md-grid md-typeset">
            
  Test

          </div>
        </aside>
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://docs.ixpmanager.org" title="IXP Manager Documentation" class="md-header-nav__button md-logo" aria-label="IXP Manager Documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            IXP Manager Documentation
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Nagios
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/inex/ixp-manager-docs-md/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../install/" class="md-tabs__link">
          Installation
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../usage/operational-notes/" class="md-tabs__link">
          General Usage
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../api/" class="md-tabs__link md-tabs__link--active">
          Features
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../grapher/introduction/" class="md-tabs__link">
          Grapher
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../sflow/" class="md-tabs__link">
          Sflow Support
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../dev/introduction/" class="md-tabs__link">
          Development
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://docs.ixpmanager.org" title="IXP Manager Documentation" class="md-nav__button md-logo" aria-label="IXP Manager Documentation">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    IXP Manager Documentation
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/inex/ixp-manager-docs-md/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Installation
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Installation" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Installation
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/automated-script/" title="Automated Script" class="md-nav__link">
      Automated Script
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/maint-mode/" title="Maintenance Mode" class="md-nav__link">
      Maintenance Mode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/manually/" title="Manual Installation" class="md-nav__link">
      Manual Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/upgrading/" title="Upgrading" class="md-nav__link">
      Upgrading
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/runtime/" title="Runtime Configuration" class="md-nav__link">
      Runtime Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/next-steps/" title="Post-Install Steps" class="md-nav__link">
      Post-Install Steps
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      General Usage
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="General Usage" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        General Usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/operational-notes/" title="Operational Notes" class="md-nav__link">
      Operational Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/authentication/" title="Authentication" class="md-nav__link">
      Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/contacts/" title="Contacts" class="md-nav__link">
      Contacts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/customers/" title="Customers / Members" class="md-nav__link">
      Customers / Members
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/customer-notes/" title="Customer Notes" class="md-nav__link">
      Customer Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/customer-tags/" title="Customer Tags" class="md-nav__link">
      Customer Tags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/interfaces/" title="Customer Connections" class="md-nav__link">
      Customer Connections
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/users/" title="Users" class="md-nav__link">
      Users
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/switches/" title="Switches" class="md-nav__link">
      Switches
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../usage/email/" title="Email" class="md-nav__link">
      Email
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Features
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Features" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        <span class="md-nav__icon md-icon"></span>
        Features
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../as112/" title="AS112" class="md-nav__link">
      AS112
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../console-servers/" title="Console Servers" class="md-nav__link">
      Console Servers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cronjobs/" title="Cron Jobs" class="md-nav__link">
      Cron Jobs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../patch-panels/" title="Cross Connects" class="md-nav__link">
      Cross Connects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../dns-arpa/" title="DNS / ARPA" class="md-nav__link">
      DNS / ARPA
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docstore/" title="Document Store" class="md-nav__link">
      Document Store
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../grapher/introduction/" title="Grapher" class="md-nav__link">
      Grapher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../helpdesk/" title="Helpdesk Integration" class="md-nav__link">
      Helpdesk Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../irrdb/" title="IRRDB" class="md-nav__link">
      IRRDB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../ixf-export/" title="IX-F Member Export" class="md-nav__link">
      IX-F Member Export
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../looking-glass/" title="Looking Glass" class="md-nav__link">
      Looking Glass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../layer2-addresses/" title="MAC Addresses" class="md-nav__link">
      MAC Addresses
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../manrs/" title="MANRS" class="md-nav__link">
      MANRS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../member-export/" title="Member Export" class="md-nav__link">
      Member Export
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mailing-lists/" title="Mailing List Management" class="md-nav__link">
      Mailing List Management
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Nagios
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" title="Nagios" class="md-nav__link md-nav__link--active">
      Nagios
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#historical-notes" class="md-nav__link">
    Historical Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-scripts" class="md-nav__link">
    Sample Scripts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-member-reachability" class="md-nav__link">
    Monitoring Member Reachability
  </a>
  
    <nav class="md-nav" aria-label="Monitoring Member Reachability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-nagios-for-member-reachability" class="md-nav__link">
    Configuring Nagios for Member Reachability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templates-skinning" class="md-nav__link">
    Templates / Skinning
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#switch-monitoring" class="md-nav__link">
    Switch Monitoring
  </a>
  
    <nav class="md-nav" aria-label="Switch Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-checking" class="md-nav__link">
    Service Checking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#birdseye-daemon-monitoring" class="md-nav__link">
    Birdseye Daemon Monitoring
  </a>
  
    <nav class="md-nav" aria-label="Birdseye Daemon Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-checking_1" class="md-nav__link">
    Service Checking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#birdseye-bgp-session-monitoring" class="md-nav__link">
    Birdseye BGP Session Monitoring
  </a>
  
    <nav class="md-nav" aria-label="Birdseye BGP Session Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-checking_2" class="md-nav__link">
    Service Checking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../patch-panels/" title="Patch Panels" class="md-nav__link">
      Patch Panels
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../peering-manager/" title="Peering Manager" class="md-nav__link">
      Peering Manager
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../peering-matrix/" title="Peering Matrix" class="md-nav__link">
      Peering Matrix
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../peeringdb/" title="PeeringDB" class="md-nav__link">
      PeeringDB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rir-objects/" title="RIR Objects" class="md-nav__link">
      RIR Objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../reseller/" title="Reseller Functionality" class="md-nav__link">
      Reseller Functionality
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../route-collectors/" title="Route Collectors" class="md-nav__link">
      Route Collectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../route-servers/" title="Route Servers" class="md-nav__link">
      Route Servers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../routers/" title="Router Configuration" class="md-nav__link">
      Router Configuration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../rpki/" title="RPKI" class="md-nav__link">
      RPKI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../skinning/" title="Skinning" class="md-nav__link">
      Skinning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../grapher/smokeping/" title="Smokeping" class="md-nav__link">
      Smokeping
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../static-content/" title="Static Content" class="md-nav__link">
      Static Content
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../tacacs/" title="TACACS" class="md-nav__link">
      TACACS
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Grapher
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Grapher" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon"></span>
        Grapher
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../grapher/introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../grapher/api/" title="API & Permissions" class="md-nav__link">
      API &amp; Permissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../grapher/mrtg/" title="Backend: MRTG" class="md-nav__link">
      Backend: MRTG
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../grapher/sflow/" title="Backend: sflow" class="md-nav__link">
      Backend: sflow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../grapher/smokeping/" title="Backend: Smokeping" class="md-nav__link">
      Backend: Smokeping
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Sflow Support
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Sflow Support" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        <span class="md-nav__icon md-icon"></span>
        Sflow Support
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../sflow/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sflow-p2p/" title="Peer-to-peer Graphs" class="md-nav__link">
      Peer-to-peer Graphs
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Development
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Development" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon"></span>
        Development
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/introduction/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/authentication/" title="Authentication" class="md-nav__link">
      Authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/ci/" title="Continuous Integration" class="md-nav__link">
      Continuous Integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/cla/" title="Contributer License Agreement" class="md-nav__link">
      Contributer License Agreement
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/docker/" title="Docker" class="md-nav__link">
      Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/docs/" title="Documentation" class="md-nav__link">
      Documentation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/forms/" title="Forms" class="md-nav__link">
      Forms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/frontend-crud/" title="Frontend CRUD" class="md-nav__link">
      Frontend CRUD
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/grapher/" title="Grapher" class="md-nav__link">
      Grapher
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/helpders/" title="Helpers" class="md-nav__link">
      Helpers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/looking-glass/" title="Looking Glass" class="md-nav__link">
      Looking Glass
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/release-procedure/" title="Release Procedure" class="md-nav__link">
      Release Procedure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/telescope/" title="Telescope" class="md-nav__link">
      Telescope
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/users/" title="Users" class="md-nav__link">
      Users
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../dev/vagrant/" title="Vagrant" class="md-nav__link">
      Vagrant
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#historical-notes" class="md-nav__link">
    Historical Notes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-scripts" class="md-nav__link">
    Sample Scripts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-member-reachability" class="md-nav__link">
    Monitoring Member Reachability
  </a>
  
    <nav class="md-nav" aria-label="Monitoring Member Reachability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#configuring-nagios-for-member-reachability" class="md-nav__link">
    Configuring Nagios for Member Reachability
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#templates-skinning" class="md-nav__link">
    Templates / Skinning
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#switch-monitoring" class="md-nav__link">
    Switch Monitoring
  </a>
  
    <nav class="md-nav" aria-label="Switch Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-checking" class="md-nav__link">
    Service Checking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#birdseye-daemon-monitoring" class="md-nav__link">
    Birdseye Daemon Monitoring
  </a>
  
    <nav class="md-nav" aria-label="Birdseye Daemon Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-checking_1" class="md-nav__link">
    Service Checking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#birdseye-bgp-session-monitoring" class="md-nav__link">
    Birdseye BGP Session Monitoring
  </a>
  
    <nav class="md-nav" aria-label="Birdseye BGP Session Monitoring">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#service-checking_2" class="md-nav__link">
    Service Checking
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/inex/ixp-manager-docs-md/edit/master/docs/features/nagios.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="nagios-monitoring">Nagios Monitoring<a class="headerlink" href="#nagios-monitoring" title="Permanent link"></a></h1>
<p>At <a href="https://www.inex.ie/">INEX</a> we use Nagios to monitor a number of production services including:</p>
<ul>
<li>peering LAN switches;</li>
<li>member reachability (ping v4/v6);</li>
<li>member route collector sessions;</li>
<li>member route server sessions.</li>
</ul>
<p>IXP Manager can generate configuration to monitor the above for you.</p>
<p><strong>NB: IXP Manager will not install and configure Nagios from scratch. You need a working Nagios installation first and then IXP Manager will automate the above areas of the configuration.</strong></p>
<h2 id="historical-notes">Historical Notes<a class="headerlink" href="#historical-notes" title="Permanent link"></a></h2>
<p>If you have used Nagios on IXP Manager &lt;4.5, then how the configuration is generated has changed. The <a href="https://github.com/inex/IXP-Manager/wiki/Nagios">older documentation may be available here</a>. In previous versions of IXP Manager, we generated entire / monolithic Nagios configuration files. We have found in practice that this does not scale well and creates a number of limitations.</p>
<p>IXP Manager &gt;= v4.5 now simply creates the targets on a per VLAN and protocol basis.</p>
<h2 id="sample-scripts">Sample Scripts<a class="headerlink" href="#sample-scripts" title="Permanent link"></a></h2>
<p>You will find sample scripts for pulling Nagios configuration from IXP Manager and reloading Nagios at:</p>
<p>https://github.com/inex/IXP-Manager/tree/master/tools/runtime/nagios</p>
<h2 id="monitoring-member-reachability">Monitoring Member Reachability<a class="headerlink" href="#monitoring-member-reachability" title="Permanent link"></a></h2>
<p>We monitor all member router interfaces (unless asked not to) via ICMP[v6] pings with Nagios. This is all controlled by the Nagios configuration created with this feature.</p>
<p>To enable / disable these checks, edit the VLAN interface configuration and set IPvX Can Ping appropriately. <em>Note that when IPvX Can Ping is disabled, the host definition is created anyway as this would be used for other Nagios checks such as route collector sessions.</em></p>
<p>There is an additional option when editing a member's VLAN interface called <em>Busy Host</em>. This changes the Nagios ping fidelity from <code>250.0,20%!500.0,60%</code> to <code>1000.0,80%!2000.0,90%</code> (using the default object definitions which are configurable). This is useful for routers with slow / rate limited control planes.</p>
<p>Members are added to a number of hostgroups also:</p>
<ul>
<li>a per-switch hostgroup;</li>
<li>a per cabinet hostgroup;</li>
<li>a per location / data centre hostgroup;</li>
<li>an all members hostgroup.</li>
</ul>
<p>These hostgroups are very useful to single out issues and for post-maintenance checks.</p>
<p>You can use the <strong>IXP Manager</strong> API to get the Nagios configuration for a given VLAN and protocol using the following endpoint format (both GET and POST requests work):</p>
<div class="highlight"><pre><span></span><code>https://ixp.example.com/api/v4/nagios/customers/{vlanid}/{protocol}
</code></pre></div>

<p>where:</p>
<ul>
<li><code>vlanid</code> is the database ID (<em>DB ID</em>) of the VLAN. You can find the DB ID in IXP Manager in the VLAN table (select <em>VLANs</em> from the left hand side menu).</li>
<li><code>protocol</code> is either <code>4</code> for <code>IPv4</code> or 6 for <code>IPv6</code>.</li>
</ul>
<p>If either of these are invalid, the API will return with a HTTP 404 response.</p>
<p>And example of a target in the response is:</p>
<div class="highlight"><pre><span></span><code>###############################################################################################
###
### Packet Clearing House DNS
###
### Equinix DB2 (Kilcarbery) / Packet Clearing House DNS / swi1-kcp1-1.
###

### Host: 185.6.36.60 / inex.woodynet.net / Peering VLAN #1.

define host {
    use                     ixp-manager-member-host
    host_name               packet-clearing-house-dns-as42-ipv4-vlanid2-vliid109
    alias                   Packet Clearing House DNS / swi1-kcp1-1 / Peering VLAN #1.
    address                 185.6.36.60
}

### Service: 185.6.36.60 / inex.woodynet.net / Peering VLAN #1.

define service {
    use                     ixp-manager-member-ping-service
    host_name               packet-clearing-house-dns-as42-ipv4-vlanid2-vliid109
}
</code></pre></div>

<h3 id="configuring-nagios-for-member-reachability">Configuring Nagios for Member Reachability<a class="headerlink" href="#configuring-nagios-for-member-reachability" title="Permanent link"></a></h3>
<p>You will notice that the above configuration example is very light and is missing an awful lot of Nagios required configuration directives. This is intentional so that IXP Manager is not too prescriptive and allows you to define your own Nagios objects without having to resort to skinning IXP Manager.</p>
<p>Two of the most important elements of Nagios configuration which you need to understand are <a href="https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/3/en/objectdefinitions.html">object definitions</a> and <a href="https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/3/en/objectinheritance.html">object inheritance</a>.</p>
<p>You can pass three optional parameters to Nagios via GET/POST and these are:</p>
<ol>
<li><code>host_definition</code>; defaults to: <code>ixp-manager-member-host</code>.</li>
<li><code>service_definition</code>; defaults to <code>ixp-manager-member-service</code>.</li>
<li><code>ping_service_definition</code>; defaults to: <code>ixp-manager-member-ping-service</code>.</li>
<li><code>ping_busy_service_definition</code>; defaults to: <code>ixp-manager-member-ping-busy-service</code>.</li>
</ol>
<p>An example of changing two of these parameters is:</p>
<div class="highlight"><pre><span></span><code>curl --data <span class="s2">&quot;host_definition=my-host-def&amp;service_definition=my-service-def&quot;</span> -X POST <span class="se">\</span>
    -H <span class="s2">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span> <span class="se">\</span>
    -H <span class="s2">&quot;X-IXP-Manager-API-Key: my-ixp-manager-api-key&quot;</span> <span class="se">\</span>
    https://ixpexample.com/api/v4/nagios/customers/2/4
</code></pre></div>

<p>An example of the three objects that INEX use for this are:</p>
<div class="highlight"><pre><span></span><code>define host {
    name                    ixp-manager-member-host
    check_command           check-host-alive
    check_period            24x7
    max_check_attempts      10
    notification_interval   120
    notification_period     24x7
    notification_options    d,u,r
    contact_groups          admins
    register                0
}

define service {
    name                    ixp-manager-member-service
    check_period            24x7
    max_check_attempts      10
    check_interval          5
    retry_check_interval    1
    contact_groups          admins
    notification_interval   120
    notification_period     24x7
    notification_options    w,u,c,r
    register                0
}

define service {
    name                    ixp-manager-member-ping-service
    use                     ixp-manager-member-service
    service_description     PING
    check_command           check_ping!250.0,20%!500.0,60%
    register                0
}

define service {
    name                    ixp-manager-member-ping-busy-service
    use                     ixp-manager-member-service
    service_description     PING-Busy
    check_command           check_ping!1000.0,80%!2000.0,90%
    register                0
}
</code></pre></div>

<h3 id="templates-skinning">Templates / Skinning<a class="headerlink" href="#templates-skinning" title="Permanent link"></a></h3>
<p>You can use <a href="../skinning/">skinning</a> to make changes to the bundled <code>default</code> template or, <strong>preferably</strong>, add your own.</p>
<p>Let's say you wanted to add your own template called <code>mytemplate1</code> and your skin is named <code>myskin</code>. The best way to proceed is to copy the bundled example:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$IXPROOT</span>
mkdir -p resources/skins/myskin/api/v4/nagios/customers
cp resources/views/api/v4/nagios/customers/default.foil.php resources/skins/myskin/api/v4/nagios/customers/mytemplate1.foil.php
</code></pre></div>

<p>You can now edit this template as required. The only constraint on the template name is it can only contain characters from the classes <code>a-z, 0-9, -</code>. <strong>NB:</strong> do not use uppercase characters.</p>
<p>You can then elect to use this template by tacking the name onto the API request:</p>
<div class="highlight"><pre><span></span><code>https://ixp.example.com/api/v4/nagios/customers/{vlanid}/{protocol}/{template}
</code></pre></div>

<p>where, in this example, <code>{template}</code> would be: <code>mytemplate1</code>.</p>
<p><em>As a policy, INEX tends to use the bundled templates and as such they should be fit for general purpose.</em></p>
<h2 id="switch-monitoring">Switch Monitoring<a class="headerlink" href="#switch-monitoring" title="Permanent link"></a></h2>
<p>We monitor all production peering LAN switches for a number of difference services (see below).</p>
<p>IXP Manager produces a host configuration for each production switch such as:</p>
<div class="highlight"><pre><span></span><code>#
# swi2-dc1-1 - DUB01.XX.YY.ZZ, Data Centre DUB1.
#

define host {
    use                     ixp-manager-production-switch
    host_name               swi2-dc1-1.mgmt.inex.ie
    alias                   swi2-dc1-1
    address                 192.0.2.4
}
</code></pre></div>

<p>Members are added to a number of hostgroups also:</p>
<ul>
<li>switches per location / data centre;</li>
<li>all switches in the requested infrastructure;</li>
<li>grouped by vendor name (the vendor's <em>shortname</em> as defined in IXP Manager);</li>
<li>grouped by vendor model (as discovered by SNMP).</li>
</ul>
<p>These hostgroups are very useful when defining service checks.</p>
<p>You can use the <strong>IXP Manager</strong> API to get the Nagios configuration for a given infrastructure using the following endpoint format (both GET and POST requests work):</p>
<div class="highlight"><pre><span></span><code>https://ixp.example.com/api/v4/nagios/switches/{infraid}
</code></pre></div>

<p>where:</p>
<ul>
<li><code>infraid</code> is the database ID (<em>DB ID</em>) of the infrastructure. You can find the DB ID in IXP Manager in the infrastructures table (select <em>Infrastructures</em> from the left hand side menu).</li>
</ul>
<p>You can use <a href="../skinning/">skinning</a> to make changes to the bundled <code>default</code> template or, <strong>preferably</strong>, add your own.</p>
<p>Let's say you wanted to add your own template called <code>myswtemplate1</code> and your skin is named <code>myskin</code>. The best way to proceed is to copy the bundled example:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$IXPROOT</span>
mkdir -p resources/skins/myskin/api/v4/nagios/switches
cp resources/views/api/v4/nagios/switches/default.foil.php resources/skins/myskin/api/v4/nagios/switches/myswtemplate1.foil.php
</code></pre></div>

<p>You can then elect to use this template by tacking the name onto the API request:</p>
<div class="highlight"><pre><span></span><code>https://ixp.example.com/api/v4/nagios/switches/{infraid}/{template}
</code></pre></div>

<p>where, in this example, <code>{template}</code> would be: <code>myswtemplate1</code>.</p>
<p>You can pass one optional parameter to Nagios via GET/POST which is the host definition to inherit from (see customer reachability testing about for full details and examples):</p>
<div class="highlight"><pre><span></span><code>curl --data <span class="s2">&quot;host_definition=my-sw-host-def&quot;</span> -X POST <span class="se">\</span>
    -H <span class="s2">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span> <span class="se">\</span>
    -H <span class="s2">&quot;X-IXP-Manager-API-Key: my-ixp-manager-api-key&quot;</span> <span class="se">\</span>
    https://ixpexample.com/api/v4/nagios/switches/2
</code></pre></div>

<h3 id="service-checking">Service Checking<a class="headerlink" href="#service-checking" title="Permanent link"></a></h3>
<p>The recommended way to check various services on your production switches is to use the host groups created by the above switch API call. An example of the hostgroups produced include:</p>
<ol>
<li><code>ixp-production-switches-infraid-2</code>: all switches on an infrastructure with DB ID 2;</li>
<li><code>ixp-switches-infraid-2-dc-dub1</code>: all switches in location dc-dub1;</li>
<li><code>ixp-switches-infraid-2-extreme</code>: all Extreme switches on an infrastructure with DB ID 2; and</li>
<li><code>ixp-switches-infraid-2-extreme-x670g2-48x-4q</code>: all Extreme switches of model X670G2-48x-4q on an infrastructure with DB ID 2.</li>
</ol>
<p>Using these, you can create generic service definitions to apply to all hosts such as:</p>
<div class="highlight"><pre><span></span><code>define service{
    use                             my-ixp-production-switch-service
    hostgroup_name                  ixp-production-switches-infraid-1, ixp-production-switches-infraid-2
    service_description             ping - IPv4
    check_command                   check_ping_ipv4!10!100.0,10%!200.0,20%
}

define service  {
    use                             my-ixp-production-switch-service
    hostgroup_name                  ixp-production-switches-infraid-1, ixp-production-switches-infraid-2
    service_description             SSH
    check_command                   check_ssh
}
</code></pre></div>

<p>You can target vendor / model specific checks as appropriate:</p>
<div class="highlight"><pre><span></span><code>define service{
    use                             my-ixp-production-switch-service
    hostgroup_name                  ixp-switches-infraid-1-extreme, ixp-switches-infraid-2-extreme
    service_description             Chassis
    check_command                   check_extreme_chassis
}
</code></pre></div>

<p>The one thing you'll need to keep an eye on is adding hostgroups to service checks as you create new infrastructures / add new switch vendors / models.</p>
<p><strong>Hint:</strong> over the years, we at <a href="https://www.inex.ie/">INEX</a> have written a number of switch chassis check scripts and these can be found on Github at <a href="https://github.com/barryo/nagios-plugins">barryo/nagios-plugins</a>.</p>
<p>For example the Extreme version checks and returns something like:</p>
<blockquote>
<p>OK - CPU: 5sec - 10%. Uptime: 62.8 days. PSUs: 1 - presentOK: 2 - presentOK:. Overall system power state: redundant power available. Fans: [101 - OK (4311 RPM)]: [102 - OK (9273 RPM)]: [103 - OK (4468 RPM)]: [104 - OK (9637 RPM)]: [105 - OK (4165 RPM)]: [106 - OK (9273 RPM)]:. Temp: 34'C. Memory (slot:usage%): 1:29%.</p>
</blockquote>
<h2 id="birdseye-daemon-monitoring">Birdseye Daemon Monitoring<a class="headerlink" href="#birdseye-daemon-monitoring" title="Permanent link"></a></h2>
<p>We monitor our Bird instances at INEX directly through Birdseye, the software we use for our <a href="../looking-glass/">looking glass</a>. This means it is currently tightly coupled to Bird and Birdseye until such time as we look at a second router software.</p>
<p>IXP Manager produces a host and service configuration for each router such as:</p>
<div class="highlight"><pre><span></span><code>define host     {
        use                     ixp-manager-host-birdseye-daemon
        host_name               bird-rc1q-cork-ipv4
        alias                   INEX Cork - Quarantine Route Collector - IPv4
        address                 10.40.5.134
        _api_url                 http://rc1q-ipv4.cork.inex.ie/api
}

define service     {
    use                     ixp-manager-service-birdseye-daemon
    host_name               bird-rc1q-cork-ipv4
}
</code></pre></div>

<p>You can use the <strong>IXP Manager</strong> API to get the Nagios configuration for all or a given VLAN using the following endpoint format (both GET and POST requests work):</p>
<div class="highlight"><pre><span></span><code>https://ixp.example.com/api/v4/nagios/birdseye-daemons
https://ixp.example.com/api/v4/nagios/birdseye-daemons/{template}
https://ixp.example.com/api/v4/nagios/birdseye-daemons/default/{vlanid}
https://ixp.example.com/api/v4/nagios/birdseye-daemons/{template}/{vlanid}
</code></pre></div>

<p>where:</p>
<ul>
<li><code>{template}</code> is the optional skin (see below).</li>
<li><code>{vlanid}</code> is the VLAN id to limit the results to. If setting this, you need to provide a template also (or <code>default</code> for the standard template).</li>
</ul>
<p>You can use <a href="../skinning/">skinning</a> to make changes to the bundled <code>default</code> template or, <strong>preferably</strong>, add your own.</p>
<p>Let's say you wanted to add your own template called <code>mybetemplate1</code> and your skin is named <code>myskin</code>. The best way to proceed is to copy the bundled example:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$IXPROOT</span>
mkdir -p resources/skins/myskin/api/v4/nagios/birdseye-daemons
cp resources/views/api/v4/nagios/birdseye-daemons/default.foil.php resources/skins/myskin/api/v4/nagios/birdseye-daemons/mybetemplate1.foil.php
</code></pre></div>

<p>You can then elect to use this template by tacking the name onto the API request:</p>
<div class="highlight"><pre><span></span><code>https://ixp.example.com/api/v4/nagios/birdseye-daemons/{template}
</code></pre></div>

<p>where, in this example, <code>{template}</code> would be: <code>mybetemplate1</code>.</p>
<p>You can pass two optional parameter to Nagios via GET/POST which is the host and service definition to inherit from (see customer reachability testing about for full details and examples):</p>
<div class="highlight"><pre><span></span><code>curl --data <span class="s2">&quot;host_definition=my-be-host-def&amp;service_definition=my-be-srv-def&quot;</span> -X POST <span class="se">\</span>
    -H <span class="s2">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span> <span class="se">\</span>
    -H <span class="s2">&quot;X-IXP-Manager-API-Key: my-ixp-manager-api-key&quot;</span> <span class="se">\</span>
    https://ixpexample.com/api/v4/nagios/birdseye-daemons
</code></pre></div>

<p>The default values for the host and service definitions are <code>ixp-manager-host-birdseye-daemon</code> and <code>ixp-manager-service-birdseye-daemon</code> respectively.</p>
<h3 id="service-checking_1">Service Checking<a class="headerlink" href="#service-checking_1" title="Permanent link"></a></h3>
<p>You will need to create a parent host and service definition for the generated configuration such as:</p>
<div class="highlight"><pre><span></span><code>define host {
    name                    ixp-manager-host-birdseye-daemon
    check_command           check-host-alive
    check_period            24x7
    max_check_attempts      10
    notification_interval   120
    notification_period     24x7
    notification_options    d,u,r
    contact_groups          admins
    register                0
}

define service {
    name                    ixp-manager-service-birdseye-daemon
    service_description     Bird BGP Service
    check_command           check_birdseye_daemon!$_HOSTAPIURL$
    check_period            24x7
    max_check_attempts      10
    check_interval          5
    retry_check_interval    1
    contact_groups          admins
    notification_interval   120
    notification_period     24x7
    notification_options    w,u,c,r
    register                0
}

define command{
        command_name    check_birdseye_daemon
        command_line    /usr/local/nagios-plugins-other/nagios-check-birdseye.php -a $ARG1$
}
</code></pre></div>

<p>The Nagios script we use is bundled with <a href="https://github.com/inex/birdseye">inex/birdseye</a> and can be found <a href="https://github.com/inex/birdseye/tree/master/bin">here</a>.</p>
<p>Typical Nagios state output:</p>
<blockquote>
<p>OK: Bird 1.6.2. Bird's Eye 1.0.4. Router ID 192.0.2.126. Uptime: 235 days. Last Reconfigure: 2017-07-17 16:00:04.26 BGP sessions up of 28.</p>
</blockquote>
<h2 id="birdseye-bgp-session-monitoring">Birdseye BGP Session Monitoring<a class="headerlink" href="#birdseye-bgp-session-monitoring" title="Permanent link"></a></h2>
<p>We monitor our Bird route collector, route server and AS112 Bird BGP sessions at INEX directly through Birdseye, the software we use for our <a href="../looking-glass/">looking glass</a>. This means it is currently tightly coupled to Bird and Birdseye until such time as we look at a second router software.</p>
<p>IXP Manager produces a host and service configuration for each router type such as:</p>
<div class="highlight"><pre><span></span><code>### Router: INEX LAN1 - Route Collector - IPv4 / 192.0.2.126.

define service     {
    use                     ixp-manager-member-bgp-session-service
    host_name               as112-reverse-dns-as112-ipv4-vlanid2-vliid99
    service_description     BGP session to rc1-lan1-ipv4 (INEX LAN1 - Route Collector - IPv4)
    _api_url                http://www.example.com/api
    _protocol               pb_0099_as112
}
</code></pre></div>

<p>The configuration also includes hostgroups for the given VLAN, protocol and type for:</p>
<ul>
<li>per-router;</li>
<li>all sessions.</li>
</ul>
<p>You can use the <strong>IXP Manager</strong> API to get the Nagios configuration for a given protocol, VLAN and router type using the following templates:</p>
<div class="highlight"><pre><span></span><code>https://ixp.example.com/api/v4/nagios/birdseye-bgp-sessions/{vlanid}/{protocol}/{type}
https://ixp.example.com/api/v4/nagios/birdseye-bgp-sessions/{vlanid}/{protocol}/{type}/{template}
</code></pre></div>

<p>where:</p>
<ul>
<li><code>{vlanid}</code> is the VLAN id to generate the configuration for.</li>
<li><code>{protocol}</code> is either 4 (ipv4) or 6 (ipv6).</li>
<li><code>{type}</code> is one of (these are defined in <a href="https://github.com/inex/IXP-Manager/blob/master/database/Entities/Router.php">Entities\Router</a>):</li>
<li><code>1</code> for route servers;</li>
<li><code>2</code> for route collectors;</li>
<li><code>3</code> for AS112</li>
</ul>
<p>You can use <a href="../skinning/">skinning</a> to make changes to the bundled <code>default</code> template or, <strong>preferably</strong>, add your own.</p>
<p>Let's say you wanted to add your own template called <code>myrstemplate1</code> and your skin is named <code>myskin</code>. The best way to proceed is to copy the bundled example:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span> <span class="nv">$IXPROOT</span>
mkdir -p resources/skins/myskin/api/v4/nagios/birdseye-bgp-sessions
cp resources/views/api/v4/nagios/birdseye-bgp-sessions/default.foil.php resources/skins/myskin/api/v4/nagios/birdseye-bgp-sessions/myrstemplate1.foil.php
</code></pre></div>

<p>You can then elect to use this template by tacking the name onto the API request:</p>
<div class="highlight"><pre><span></span><code>https://ixp.example.com/api/v4/nagios/birdseye-bgp-sessions/{vlanid}/{protocol}/{type}/{template}
</code></pre></div>

<p>where, in this example, <code>{template}</code> would be: <code>myrstemplate1</code>.</p>
<p>You can pass one optional parameter to Nagios via GET/POST which is the service definition to inherit from (see customer reachability testing about for full details and examples):</p>
<div class="highlight"><pre><span></span><code>curl --data <span class="s2">&quot;service_definition=my-rs-srv-def&quot;</span> -X POST <span class="se">\</span>
    -H <span class="s2">&quot;Content-Type: application/x-www-form-urlencoded&quot;</span> <span class="se">\</span>
    -H <span class="s2">&quot;X-IXP-Manager-API-Key: my-ixp-manager-api-key&quot;</span> <span class="se">\</span>
    https://ixpexample.com/api/v4/nagios/birdseye-bgpsessions/2/4/1
</code></pre></div>

<p>The default values for the service definition is <code>ixp-manager-member-bgp-session-service</code> respectively.</p>
<h3 id="service-checking_2">Service Checking<a class="headerlink" href="#service-checking_2" title="Permanent link"></a></h3>
<p>You will need to create a parent service definition and a check command for the generated configuration such as:</p>
<div class="highlight"><pre><span></span><code>define service {
    name                    ixp-manager-member-bgp-session-service
    service_description     Member Bird BGP Sessions
    check_period            24x7
    max_check_attempts      10
    check_interval          5
    retry_check_interval    1
    contact_groups          admins
    notification_interval   120
    notification_period     24x7
    notification_options    w,u,c,r
    register                0
    check_command           check_birdseye_bgp_session!$_SERVICEAPI_URL!$_SERVICEPROTOCOL
}

define command{
    command_name    check_birdseye_bgp_session
    command_line    /path/to/nagios-check-birdseye-bgp-sessions.php -a $ARG1$ -p $ARG2$ -n
}
</code></pre></div>

<p>The Nagios script we use is bundled with <a href="https://github.com/inex/birdseye">inex/birdseye</a> and can be found <a href="https://github.com/inex/birdseye/tree/master/bin">here</a>.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../mailing-lists/" title="Mailing List Management" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Mailing List Management
              </div>
            </div>
          </a>
        
        
          <a href="../patch-panels/" title="Patch Panels" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Patch Panels
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            &copy; 2017-2020, Internet Neutral Exchange Association Company Limited by Guarantee (INEX).<br><a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://licensebuttons.net/l/by-sa/4.0/80x15.png" /></a>&nbsp;This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.3636a4ec.min.js"></script>
      <script src="../../assets/javascripts/bundle.e9fe3281.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ["tabs"],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.5eca75d3.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>